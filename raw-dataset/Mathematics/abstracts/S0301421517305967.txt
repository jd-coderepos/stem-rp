We analyze the effectiveness of a forward capacity market (FCM) with long-term contracts in an electricity market in the presence of a growing share of renewable energy. An agent-based model is used for this analysis. Capacity markets can compensate for the deteriorating incentive to invest in controllable power plants when the share of variable renewable energy sources grows, but may create volatile prices themselves. Capacity markets with long-term contracts have been developed, e.g. in the UK, to stabilize capacity prices. In our analysis, a FCM is effective in providing the required adequacy level and leads to lower cost to consumers and more stable capacity prices, as compared to a yearly capacity market. In case of a demand shock, a FCM may develop an investment cycle, but it still maintains security of supply. Its main effect on the power plant portfolio is more investment in peak plant.