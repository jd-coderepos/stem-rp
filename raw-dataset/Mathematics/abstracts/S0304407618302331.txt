A model of labour supply and taxation is developed in which observed hours reflect both the distribution of preferences and restrictions on choices. Hours restrictions are placed in a constrained rational choice setting in which the set of alternative hours on offer is restricted. Choices are made on a random subset of possible hours. We focus on the case where the choice set contains at most two offers. We show that when the choice set distribution is known, preferences can be identified. Conversely we show that, where preferences are known, the choice set distribution can be fully recovered. Conditions for identification of both preferences and the distribution of choice sets are also developed. We illustrate this approach in a labour supply setting with nonlinear budget constraints. Heterogeneity in the budget constraint reveals properties of the choice set. This framework is used to study the labour supply behaviour of a large sample of working age mothers in the UK, accounting for nonlinearities in the tax and welfare benefit system, fixed costs of work and restrictions on hours choices.