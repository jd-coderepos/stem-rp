On sharing, memoization, and polynomial time 