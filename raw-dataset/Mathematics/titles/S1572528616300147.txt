Stable Marriage and Roommates problems with restricted edges: Complexity and approximability 