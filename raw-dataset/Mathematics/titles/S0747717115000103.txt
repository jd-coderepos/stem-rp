A difference ring theory for symbolic summation 