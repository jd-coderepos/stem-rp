Quasi-compact endomorphisms and primary ideals in commutative unital Banach algebras 