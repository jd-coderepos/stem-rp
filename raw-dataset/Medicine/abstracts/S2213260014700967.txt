Summary Background The relationship between early-life antibiotic use and the development of wheeze and asthma has been reported in several studies but might arise as a consequence of bias rather than causal relationship. We investigated the association between antibiotic prescription and subsequent development of atopy, wheeze, and asthma exacerbations, and the relation of early life antibiotic prescription with anti-infective immunity and genetic variants on asthma susceptibility locus 17q21. Methods Children in a population-based birth cohort were followed from birth to age 11 years. Information on antibiotic prescription, wheeze, and asthma exacerbations was extracted from medical records, and the effect of antibiotic prescription assessed with longitudinal analyses. We assessed immune responses of peripheral blood mononuclear cells, taken at age 11 years, to viruses (rhinovirus and respiratory syncytial virus; RSV) and bacteria (Haemophilus influenzae and Streptococcus pneumoniae) in children who either received at least one or no antibiotic prescriptions in infancy. Finally, we assessed the association of 17q21 polymorphisms with antibiotic prescription. Findings Of 984 families who gave consent, we extracted data for 916 children. We noted significantly higher risk of physician-confirmed wheezing after antibiotic prescription (hazard ratio [HR] 1·71, 95% CI 1·32–2·23; p<0·0001) and severe wheeze or asthma exacerbation after antibiotic prescription (HR 2·26, 95% CI 1·03–4·94; p=0·041). In children who wheezed, the hazards of exacerbations (2·09, 1·51–2·90; p<0·0001) and admissions to hospital (2·64, 1·49–4·70; p=0·0009) were significantly increased in the 2 years after the first antibiotic prescription. Children who received antibiotics in infancy had significantly lower induction of cytokines, which are important in host defence against virus infections to both RSV and rhinovirus; there were no differences in antibacterial responses. Variants in 17q21 were associated with an increased risk of early life antibiotic prescription. Interpretation The association between antibiotics and asthma might arise through a complex confounding by indication. Hidden factors that may increase the likelihood of both early life antibiotic prescription and later asthma are an increased susceptibility to viral infections consequent upon impaired antiviral immunity and genetic variants on 17q21. Funding Moulton Charitable Foundation and Medical Research Council.