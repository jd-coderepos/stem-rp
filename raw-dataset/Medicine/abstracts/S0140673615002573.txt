Summary Background Optimal drug treatment for patients with resistant hypertension is undefined. We aimed to test the hypotheses that resistant hypertension is most often caused by excessive sodium retention, and that spironolactone would therefore be superior to non-diuretic add-on drugs at lowering blood pressure. Methods In this double-blind, placebo-controlled, crossover trial, we enrolled patients aged 18–79 years with seated clinic systolic blood pressure 140 mm Hg or greater (or ≥135 mm Hg for patients with diabetes) and home systolic blood pressure (18 readings over 4 days) 130 mm Hg or greater, despite treatment for at least 3 months with maximally tolerated doses of three drugs, from 12 secondary and two primary care sites in the UK. Patients rotated, in a preassigned, randomised order, through 12 weeks of once daily treatment with each of spironolactone (25–50 mg), bisoprolol (5–10 mg), doxazosin modified release (4–8 mg), and placebo, in addition to their baseline blood pressure drugs. Random assignment was done via a central computer system. Investigators and patients were masked to the identity of drugs, and to their sequence allocation. The dose was doubled after 6 weeks of each cycle. The hierarchical primary endpoints were the difference in averaged home systolic blood pressure between spironolactone and placebo, followed (if significant) by the difference in home systolic blood pressure between spironolactone and the average of the other two active drugs, followed by the difference in home systolic blood pressure between spironolactone and each of the other two drugs. Analysis was by intention to treat. The trial is registered with EudraCT number 2008-007149-30, and ClinicalTrials.gov number, NCT02369081. Findings Between May 15, 2009, and July 8, 2014, we screened 436 patients, of whom 335 were randomly assigned. After 21 were excluded, 285 patients received spironolactone, 282 doxazosin, 285 bisoprolol, and 274 placebo; 230 patients completed all treatment cycles. The average reduction in home systolic blood pressure by spironolactone was superior to placebo (–8·70 mm Hg [95% CI −9·72 to −7·69]; p<0·0001), superior to the mean of the other two active treatments (doxazosin and bisoprolol; −4·26 [–5·13 to −3·38]; p<0·0001), and superior when compared with the individual treatments; versus doxazosin (–4·03 [–5·04 to −3·02]; p<0·0001) and versus bisoprolol (–4·48 [–5·50 to −3·46]; p<0·0001). Spironolactone was the most effective blood pressure-lowering treatment, throughout the distribution of baseline plasma renin; but its margin of superiority and likelihood of being the best drug for the individual patient were many-fold greater in the lower than higher ends of the distribution. All treatments were well tolerated. In six of the 285 patients who received spironolactone, serum potassium exceeded 6·0 mmol/L on one occasion. Interpretation Spironolactone was the most effective add-on drug for the treatment of resistant hypertension. The superiority of spironolactone supports a primary role of sodium retention in this condition. Funding The British Heart Foundation and National Institute for Health Research.