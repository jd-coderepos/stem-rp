Summary Background Although childhood overweight and obesity prevalence has increased substantially worldwide in the past three decades, scarce evidence exists for effective preventive strategies. We aimed to establish whether a school-based intervention for children aged 9–10 years would prevent excessive weight gain after 24 months. Methods This pragmatic cluster randomised controlled trial of the Healthy Lifestyles Programme (HeLP), a school-based obesity prevention intervention, was done in 32 schools in southwest England. All state-run primary and junior schools in Devon and Plymouth (UK) with enough pupils for at least one year-5 class were eligible. Schools were assigned (1:1) using a computer-generated sequence to either intervention or control, stratified by the number of year-5 classes (one vs more than one) and the proportion of children eligible for free school meals (<19% [the national average] vs ≥19%). HeLP was delivered to year-5 children (ages 9–10 years) over 1 year, and included dynamic and interactive activities such as physical activity workshops, education sessions delivered by teachers with short homework tasks, drama sessions, and setting goals to modify behaviour (with parental support and one-to-one discussions with HeLP coordinators). The primary outcome was change in body-mass index (BMI) standard deviation score (SDS) between baseline and 24 months, analysed in children with BMI data available for both timepoints. This study is registered with the International Standard Randomised Controlled Trial register, number ISRCTN15811706, and the trial status is complete. Findings Between March 21, 2012, and Sept 30, 2013, 32 eligible schools with 1324 children were recruited, of which 16 schools (676 children) were randomly assigned to the HeLP intervention and 16 schools (648 children) to control. All schools that began the trial completed the intervention, and 1244 children (628 in intervention group and 616 in control group) had BMI data at both baseline and 24 months for the primary outcome analysis. Mean BMI SDS was 0·32 (SD 1·16) at baseline and 0·35 (1·25) at 24 months in the intervention group, and 0·18 (1·14) at baseline and 0·22 (1·22) at 24 months in the control group. With adjustment for school-level clustering, baseline BMI scores, sex, cohort, and number of year-5 classes and socioeconomic status of each school, the mean difference in BMI SDS score (intervention–control) at 24 months was −0·02 (95% CI −0·09 to 0·05), p=0·57. One parent reported an adverse event related to their child's eating and activity behaviours, but agreed for the child to continue trial participation after discussion with the chief investigator. Interpretation Despite a theoretically informed and extensively piloted intervention that achieved high levels of engagement, follow-up, and fidelity of delivery, we found no effect of the intervention on preventing overweight or obesity. Although schools are an ideal setting in which to deliver population-based interventions, school-based interventions might not be sufficiently intense to affect both the school and the family environment, and hence the weight status of children. Future research should focus on more upstream determinants of obesity and use whole-systems approaches. Funding UK National Institute for Health Research, Public Health Research Programme.