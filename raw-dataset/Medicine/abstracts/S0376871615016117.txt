Aim To assess the relationship between testing positive for opiates and/or cocaine and prior offending. Methods 139,925 persons (107,573 men) identified from a saliva test for opiate and cocaine metabolites following arrest in England and Wales, 1 April 2005–31 March 2009, were case-linked with 2-year recorded offending history. The prior offending rate, accounting for estimated incarceration periods, was calculated by: drug-test outcome; gender; four main crime categories (acquisitive, non-acquisitive, serious acquisitive, and non-serious acquisitive) and 16 sub-categories. Rate ratio (RR) compared opiate and/or cocaine positive to dual-negative testers. Adjusted rate ratio (aRR) controlled for age at drug test. Results The relationship between testing positive for opiates and cocaine and prior 2-year offending was greater for women than men (aRR men 1.77; 95% CI: 1.75–1.79: women 3.51; 3.45–3.58). The association was weaker for those testing positive for opiates only (aRR: men: 1.66, 1.64–1.68; women 2.73, 2.66–2.80). Men testing positive for cocaine only had a lower rate of prior offending (aRR: 0.93, 0.92–0.94), women had a higher rate (aRR: 1.69, 1.64–1.74). The strongest associations were for non-serious acquisitive crimes (e.g. dually-positive: prostitution (women-only): aRR 24.9, 20.9–29.7; shoplifting: aRR men 4.05, 3.95–4.16; women 6.16, 5.92–6.41). Testing positive for opiates and cocaine was associated with violent offences among women (aRR: 1.54, 1.40–1.69) but not men (aRR: 0.98, 0.93–1.02). Conclusions Among drug-tested offenders, opiate use is associated with elevated prior offending and the association is stronger for women than men. Cocaine use is associated with prior offending only among women.