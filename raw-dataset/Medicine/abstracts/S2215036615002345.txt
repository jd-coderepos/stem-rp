Summary Background Reoffending and presence of psychiatric disorders are common in prisoners worldwide. However, whether psychiatric disorders are risk factors for reoffending is still unknown. We aimed to examine the association between psychiatric disorders, including substance use disorder, and violent reoffending. Methods We did a longitudinal cohort study of 47 326 prisoners who were imprisoned since Jan 1, 2000, and released before Dec 31, 2009, in Sweden. We obtained data for diagnosed psychiatric disorders from both inpatient and outpatient registers, and sociodemographic and criminological factors from other population-based registers. We calculated hazard ratios (HRs) for violent reoffending with Cox regression. To control for potential familial confounding, we compared sibling prisoners with and without psychiatric disorders. We calculated population attributable fraction to assess the population effect. Findings Diagnosed psychiatric disorders were associated with an increased hazard of violent reoffending in male (adjusted HR 1·63 [95% CI 1·57–1·70]) and female (2·02 [1·54–2·63]) prisoners, and these associations were independent of measured sociodemographic and criminological factors, and, in men, remained substantial after adjustment for unmeasured familial factors (2·01 [1·66–2·43]). However, findings differed between individual diagnoses and sex. We found some evidence of stronger effects on violent reoffending of alcohol and drug use disorders and bipolar disorder than of other psychiatric disorders. Alcohol use disorder seemed to have a greater effect in women than in men (women 2·08 [1·66–2·60]; men 1·63 [1·56–1·71]). The overall effects of psychiatric disorders did not differ with severity of crime. The hazard of violent reoffending increased in a stepwise way with the number of diagnosed psychiatric disorders. Assuming causality, up to 20% (95% CI 19–22) of violent reoffending in men and 40% (27–52) in women was attributable to the diagnosed psychiatric disorders that we investigated. Interpretation Certain psychiatric disorders are associated with a substantially increased hazard of violent reoffending. Because these disorders are prevalent and mostly treatable, improvements to prison mental health services could counteract the cycle of reoffending and improve both public health and safety. National violence prevention strategies should consider the role of prison health. Funding Wellcome Trust, Swedish Research Council, and Swedish Research Council for Health, Working Life and Welfare.