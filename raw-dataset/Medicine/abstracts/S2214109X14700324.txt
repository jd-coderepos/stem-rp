Summary Background Although several interventions have shown reduced HIV incidence in clinical trials, the community-level effect of effective interventions on the epidemic when scaled up is unknown. We investigated whether a multicomponent, multilevel social and behavioural prevention strategy could reduce HIV incidence, increase HIV testing, reduce HIV risk behaviour, and change social and behavioural norms. Methods For this phase 3 cluster-randomised controlled trial, 34 communities in four sites in Africa and 14 communities in Thailand were randomly allocated in matched pairs to receive 36 months of community-based voluntary counselling and testing for HIV (intervention group) or standard counselling and testing alone (control group) between January, 2001, and December, 2011. The intervention was designed to make testing more accessible in communities, engage communities through outreach, and provide support services after testing. Randomisation was done by a computer-generated code and was not masked. Data were collected at baseline (n=14 567) and after intervention (n=56 683) by cross-sectional random surveys of community residents aged 18–32 years. The primary outcome was HIV incidence and was estimated with a cross-sectional multi-assay algorithm and antiretroviral drug screening assay. Thailand was excluded from incidence analyses because of low HIV prevalence. This trial is registered at ClinicalTrials.gov, number NCT00203749. Findings The estimated incidence of HIV in the intervention group was 1·52% versus 1·81% in the control group with an estimated reduction in HIV incidence of 13·9% (relative risk [RR] 0·86, 95% CI 0·73–1·02; p=0·082). HIV incidence was significantly reduced in women older than 24 years (RR=0·70, 0·54–0·90; p=0·0085), but not in other age or sex subgroups. Community-based voluntary counselling and testing increased testing rates by 25% overall (12–39; p=0·0003), by 45% (25–69; p<0·0001) in men and 15% (3–28; p=0·013) in women. No overall effect on sexual risk behaviour was recorded. Social norms regarding HIV testing were improved by 6% (95% CI 3–9) in communities in the intervention group. Interpretation These results are sufficiently robust, especially when taking into consideration the combined results of modest reductions in HIV incidence combined with increases in HIV testing and reductions in HIV risk behaviour, to recommend the Project Accept approach as an integral part of all interventions (including treatment as prevention) to reduce HIV transmission at the community level. Funding US National Institute of Mental Health, the Division of AIDS of the US National Institute of Allergy and Infectious Diseases, and the Office of AIDS Research of the US National Institutes of Health.