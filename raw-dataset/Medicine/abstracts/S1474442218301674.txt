Summary Background Percutaneous closure of patent foramen ovale (PFO) has been shown to be superior to medical treatment alone for prevention of recurrent stroke after cryptogenic transient ischaemic attack or non-disabling stroke in patients aged 60 years or younger. The justification for trials in older patients with transient ischaemic attack or stroke depends on whether PFO is shown to be associated with cryptogenic events at older ages, for which existing evidence is conflicting, and on the population burden of PFO-associated events. Therefore, we did a population-based screening study using contrast-enhanced transcranial Doppler (bubble-TCD) to detect probable PFO as indicated by a right-to-left shunt (RLS); we also did a systematic review and meta-analysis to compare our results with previous studies. Methods In this population-based study, nested in the Oxford Vascular Study (OXVASC), we established the prevalence of any RLS, and of large RLS (>20 microbubbles), in consecutive patients attending a rapid-access transient ischaemic attack and stroke clinic, or at 1-month follow-up after stroke unit admission, with transient ischaemic attack or non-disabling ischaemic stroke, comparing cryptogenic events with those of known cause (according to Trial of Org 10172 in Acute Stroke Treatment [TOAST] criteria). We stratified participants by age, and extrapolated data to the UK population. We also did a systematic review of published studies of PFO prevalence (using transthoracic or transoesophageal echocardiography or bubble-TCD) according to stroke subtype, which included older patients and reported age-specific results, and determined by meta-analysis (including the OXVASC data) the pooled odds ratio (95% CI) of finding PFO of any size in cryptogenic events compared with events of known cause, stratified by screening modality (transthoracic or transoesophageal echocardiography or bubble-TCD). The study protocol is registered with PROSPERO, number CRD42018087074. Findings Among 572 consecutive patients with transient ischaemic attack or non-disabling stroke between Sept 1, 2014, and Oct 9, 2017 (439 [77%] patients aged >60 years, mean age 70·0 years [SD 13·7]), bubble-TCD was feasible in 523 patients (91%) of whom 397 were aged older than 60 years. Compared with those with transient ischaemic attack or stroke of known cause, patients with cryptogenic events had a higher prevalence of RLS overall (odds ratio [OR] 1·93, 95% CI 1·32–2·82; p=0·001), and in those aged older than 60 years (2·06, 1·32–3·23; p=0·001). When we pooled the OXVASC data with that from two previous smaller studies of bubble-TCD in patients aged 50 years or older, we found an association between RLS and cryptogenic events (OR 2·35, 95% CI 1·42–3·90; p=0·0009; pheterogeneity=0·15), which was consistent with the equivalent estimate from transoesophageal echocardiography studies (2·20, 1·15–4·22; p=0·02; pheterogeneity=0·02). No data on large RLS in patients with TOAST-defined cryptogenic events compared with other events were available from previous studies, but we found no evidence that the association was diminished in such cases. Of 41 patients with large RLS and cryptogenic transient ischaemic attack or non-disabling stroke in our study, 25 (61%) were aged older than 60 years, which extrapolates to 5951 patients per year in the UK (data from mid-2016). Interpretation Bubble-TCD was feasible in most older patients with transient ischaemic attack or non-disabling stroke, the association of RLS with cryptogenic events remained at older ages, and the population burden of PFO-associated events is substantial. Randomised trials of PFO closure at older ages are required and should be feasible. Funding National Institute for Health Research, Oxford Biomedical Research Centre, Wellcome Trust, and Wolfson Foundation.