Summary Background We assessed prevalences of seven sexually transmitted infections (STIs) in Peru, stratified by risk behaviours, to help to define care and prevention priorities. Methods In a 2002 household-based survey of the general population, we enrolled randomly selected 18–29-year-old residents of 24 cities with populations greater than 50 000 people. We then surveyed female sex workers (FSWs) in these cities. We gathered data for sexual behaviour; vaginal specimens or urine for nucleic acid amplification tests for Neisseria gonorrhoeae, Chlamydia trachomatis, and Trichomonas vaginalis; and blood for serological tests for syphilis, HIV, and (in subsamples) herpes simplex virus 2 (HSV2) and human T-lymphotropic virus. This study is a registered component of the PREVEN trial, number ISRCTN43722548. Findings 15 261 individuals from the general population and 4485 FSWs agreed to participate in our survey. Overall prevalence of infection with HSV2, weighted for city size, was 13·5% in men, 13·6% in women, and 60·6% in FSWs (all values in FSWs standardised to age composition of women in the general population). The prevalence of C trachomatis infection was 4·2% in men, 6·5% in women, and 16·4% in FSWs; of T vaginalis infection was 0·3% in men, 4·9% in women, and 7·9% in FSWs; and of syphilis was 0·5% in men, 0·4% in women, and 0·8% in FSWs. N gonorrhoeae infection had a prevalence of 0·1% in men and women, and of 1·6% in FSWs. Prevalence of HIV infection was 0·5% in men and FSWs, and 0·1% in women. Four (0·3%) of 1535 specimens were positive for human T-lymphotropic virus 1. In men, 65·0% of infections with HIV, 71·5% of N gonorrhoeae, and 41·4% of HSV2 and 60·9% of cases of syphilis were in the 13·3% who had sex with men or unprotected sex with FSWs in the past year. In women from the general population, 66·7% of infections with HIV and 16·7% of cases of syphilis were accounted for by the 4·4% who had been paid for sex by any of their past three partners. Interpretation Defining of high-risk groups could guide targeting of interventions for communicable diseases—including STIs—in the general Peruvian population. Funding Wellcome Trust-Burroughs Wellcome Fund Infectious Disease Initiative and US National Institutes of Health.