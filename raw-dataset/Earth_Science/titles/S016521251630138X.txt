Dynamic homogenisation of Maxwellâ€™s equations with applications to photonic crystals and localised waveforms on gratings 