With an increasing proportion of the world's population living in urban areas, probably the greatest potential for saving energy lies in designing more efficient cities. This has been known for many years and has led to the development of a large number of mathematical models designed to optimise urban energy systems. Despite the wide variety of models available, many are specific to particular energy pathways or contain specific equations for each type of technology, making them difficult to apply to a very broad spectrum of problems. Further, many models only consider a network of conversion technologies and there are very few that can include storage and transport technologies in a flexible and general manner. This paper presents a general mixed-integer linear programming (MILP) model for the simultaneous design and operation of urban energy systems. It is based on a flexible value web framework for representing integrated networks of resources and technologies. The resources represent any energy or material involved in the provision of services such as heat and electricity; whereas the technologies represent any type of technology for conversion, transport or storage of resources. It can be applied to urban energy systems problems at different temporal and spatial scales. The model is illustrated using an eco-town in central England as a case study. Demands for heat and electricity must be met by importing grid electricity, natural gas and/or two types of biomass and using a variety technologies, including domestic gas-fired boilers, domestic wood-chip boilers and various biomass-fired combined heat and power plants. The model optimises the design and operation of the integrated heat and electricity networks. The cost optimal solution indicates that all of the heat can be met using a single biomass CHP plant along with a backup boiler; electricity needs to be imported from the grid during periods of low heat demand.