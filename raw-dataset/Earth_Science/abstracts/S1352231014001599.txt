We present a flexible framework to calculate the optical properties of atmospheric aerosols at a given relative humidity based on their composition and size distribution. The similarity of this framework to climate model parameterisations allows rapid and extensive sensitivity tests of the impact of uncertainties in data or of new measurements on climate relevant aerosol properties. The data collected by the FAAM BAe-146 aircraft during the EUCAARI-LONGREX and VOCALS-REx campaigns have been used in a closure study to analyse the agreement between calculated and measured aerosol optical properties for two very different aerosol types. The agreement achieved for the EUCAARI-LONGREX flights is within the measurement uncertainties for both scattering and absorption. However, there is poor agreement between the calculated and the measured scattering for the VOCALS-REx flights. The high concentration of sulphate, which is a scattering aerosol with no absorption in the visible spectrum, made the absorption measurements during VOCALS-REx unreliable, and thus no closure study was possible for the absorption. The calculated hygroscopic scattering growth factor overestimates the measured values during EUCAARI-LONGREX and VOCALS-REx by ∼30% and ∼20%, respectively. We have also tested the sensitivity of the calculated aerosol optical properties to the uncertainties in the refractive indices, the hygroscopic growth factors and the aerosol size distribution. The largest source of uncertainty in the calculated scattering is the aerosol size distribution (∼35%), followed by the assumed hygroscopic growth factor for organic aerosol (∼15%), while the predominant source of uncertainty in the calculated absorption is the refractive index of organic aerosol (28–60%), although we would expect the refractive index of black carbon to be important for aerosol with a higher black carbon fraction.