Stochastic building occupancy models are increasingly used to underpin building energy demand models, especially those providing high-resolution electricity demand profiles. This paper describes the development of an established two-state active-occupancy model into a four-state model in which the absent/present state and the active/inactive state are treated separately. This provides a distinction between sleeping and absence and so offers an improved basis for demand modelling, particularly high-resolution thermal modelling. The model uses a first-order Markov chain technique and the paper illustrates the value of this approach in duly representing the naturally occurring correlation of occupancy states in multiply occupied dwellings. The paper also describes how the model has been enhanced to avoid under-representation of dwellings with 24h occupancy. The model has been implemented in Excel VBA and made available to download for free. The model is constructed from and verified against UK time-use survey data but could readily be adapted to use similar data from elsewhere.