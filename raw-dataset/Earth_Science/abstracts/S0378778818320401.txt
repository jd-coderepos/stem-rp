Ground source heat pumps (GSHPs) have been suggested to replace gas-based heating in urban environments to reduce greenhouse gas emissions and help to comply with the Paris Agreement. The emission reduction from GSHP depends on the carbon intensity of the electricity generation mix. Moreover, grid capacity may be limiting the introduction of these high-electricity demand GSHP systems. Photovoltaics (PV) systems help to provide additional emission reductions for residential GSHP systems. Battery energy storage systems can reduce the peak demand and allow for more GSHPs within the low voltage grid. We developed a techno-economic and environmental assessment model to quantify this impact of PV and batteries combined with residential GSHP systems. Measured demand data of 16 dwellings with GSHP and PV systems from the Netherlands were used. We show that PV can provide around 19% of the GSHP demand, while batteries enhance this by 53% and reduce the peak demand by 45%. Greenhouse gas emission of a GSHP with PV is reduced on average with 73 tCO2-eq, corresponding to a 80% reduction, over a 30-year lifetime. Dwellings with only a GSHP system have a net present values increase of around € 275 per tCO2-eq of avoided emission. This is reduced to € 230 per tCO2-eq when PV and storage is added to the system. Nevertheless, investment in GSHP systems today is not economically attractive for many dwellings. A sensitivity analysis showed that policies should focus on increasing natural gas tariffs, carbon taxation, investment subsidies or combinations of these routes to encourage sustainable heating.