A search for supersymmetry through the direct pair production of top squarks, with Higgs (H) or Z bosons in the decay chain, is performed using a data sample of proton–proton collisions at s = 8 TeV collected in 2012 with the CMS detector at the LHC. The sample corresponds to an integrated luminosity of 19.5 fb−1. The search is performed using a selection of events containing leptons and bottom-quark jets. No evidence for a significant excess of events over the standard model background prediction is observed. The results are interpreted in the context of simplified supersymmetric models with pair production of a heavier top-squark mass eigenstate t ˜ 2 decaying to a lighter top-squark mass eigenstate t ˜ 1 via either t ˜ 2 → H t ˜ 1 or t ˜ 2 → Z t ˜ 1 , followed in both cases by t ˜ 1 → t χ ˜ 1 0 , where χ ˜ 1 0 is an undetected, stable, lightest supersymmetric particle. The interpretation is performed in the region where the mass difference between the t ˜ 1 and χ ˜ 1 0 states is approximately equal to the top-quark mass ( m t ˜ 1 − m χ ˜ 1 0 ≃ m t ), which is not probed by searches for direct t ˜ 1 squark pair production. The analysis excludes top squarks with masses m t ˜ 2 < 575 GeV and m t ˜ 1 < 400 GeV at a 95% confidence level.