We evaluate the next-to-next-to-leading order soft function for the production of a massive color octet state at rest in the collision of two massless colored partons in either the fundamental or the adjoint representation. The main application of our result is the determination of the threshold expansion of the heavy-quark pair-production cross sections in the quark annihilation and gluon fusion channels. We discuss the factorization necessary for this purpose and explain the relationship between hard functions and virtual amplitudes.