We have previously described a way of describing the relation between unintegrated and integrated vertex operators in A d S 5 Ã— S 5 which uses the interpretation of the BRST cohomology as a Lie algebra cohomology and integrability properties of the AdS background. Here we clarify some details of that description, and develop a similar approach for an arbitrary curved background with nondegenerate RR bispinor. For an arbitrary curved background, the sigma-model is not integrable. However, we argue that a similar construction still works using an infinite-dimensional Lie algebroid.