A new symmetric Hamiltonian constraint operator is proposed for loop quantum gravity, which is well defined in the Hilbert space of diffeomorphism invariant states up to non-planar vertices with valence higher than three. It inherits the advantage of the original regularization method to create new vertices to the spin networks. The quantum algebra of this Hamiltonian is anomaly-free on shell, and there is less ambiguity in its construction in comparison with the original method. The regularization procedure for this Hamiltonian constraint operator can also be applied to the symmetric model of loop quantum cosmology, which leads to a new quantum dynamics of the cosmological model.