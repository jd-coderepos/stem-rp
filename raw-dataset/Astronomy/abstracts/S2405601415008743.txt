We study the generation of strong magnetic fields in magnetars and in the early universe. For this purpose we calculate the antisymmetric contribution to the photon polarization tensor in a medium consisting of an electron-positron plasma and a gas of neutrinos and antineutrinos, interacting within the Standard Model. Such a contribution exactly takes into account the temperature and the chemical potential of plasma as well as the photon dispersion law in this background matter. It is shown that a nonvanishing Chern-Simons parameter, which appears if there is a nonzero asymmetry between neutrinos and antineutrinos, leads to the instability of a magnetic field resulting to its growth. We apply our result to the description of the magnetic field amplification in the first second of a supernova explosion. It is suggested that this mechanism can explain strong magnetic fields of magnetars. Then we use our approach to study the cosmological magnetic field evolution. We find a lower bound on the neutrino asymmetries consistent with the well-known Big Bang nucleosynthesis bound in a hot universe plasma. Finally we examine the issue of whether a magnetic field can be amplified in a background matter consisting of self-interacting electrons and positrons.