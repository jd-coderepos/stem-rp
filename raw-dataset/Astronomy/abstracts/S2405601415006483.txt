The CMS muon system has played a key role for many physics results obtained from the LHC Run 1 data. The LHC will increase the beam energy as well as progressively increase the peak instantaneous luminosity in Run 2 and in the following years. Significant consolidation and upgrade activities are ongoing, in order to improve the CMS muon detectors and trigger performance and robustness. With LHC and then HL-LHC running beyond 2030, the large accumulated radiation dose, the high pileup environment, and the ageing of several detector and electronics components become challenges that can only be met with further development and upgrade work. We will introduce the CMS muon system and present the consolidation work in preparation for LHC Run 2. We will then describe the main constraints and the solutions proposed for the upgrade of the muon detector system towards HL-LHC.