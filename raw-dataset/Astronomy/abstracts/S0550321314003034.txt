We study the canonical quantization of a bosonic string in presence of N twist fields. This generalizes the quantization of the twisted string in two ways: the in and out states are not necessarily twisted and the number of twist fields N can be bigger than 2. In order to quantize the theory we need to find the normal modes. Then we need to define a product between two modes which is conserved. Because of this we need to use the Kleinâ€“Gordon product and to separate the string coordinate into the classical and the quantum part. The quantum part has different boundary conditions than the original string coordinates but these boundary conditions are precisely those which make the operator describing the equation of motion self adjoint. The splitting of the string coordinates into a classical and quantum part allows the formulation of an improved overlap principle. Using this approach we then proceed in computing the generating function for the generic correlator with L untwisted operators and N (excited) twist fields for branes at angles. We recover as expected the results previously obtained using the path integral. This construction explains why these correlators are given by a generalization of the Wick theorem.