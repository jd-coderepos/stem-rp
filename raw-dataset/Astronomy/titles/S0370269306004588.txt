All-orders resummation for diphoton production at hadron colliders 