Solving the flavour problem with hierarchical fermion wave functions 