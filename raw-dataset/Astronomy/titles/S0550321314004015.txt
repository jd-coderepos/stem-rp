Casimir pistons with general boundary conditions 