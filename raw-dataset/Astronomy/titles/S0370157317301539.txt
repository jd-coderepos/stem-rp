Molecular systems with open boundaries: Theory and simulation 