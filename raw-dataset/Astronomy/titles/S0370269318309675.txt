Theoretical constraints on supersymmetric models: Perturbative unitarity vs. vacuum stability 