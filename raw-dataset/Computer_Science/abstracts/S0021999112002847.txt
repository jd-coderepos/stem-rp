Dynamical energy analysis was recently introduced as a new method for determining the distribution of mechanical and acoustic wave energy in complex built up structures. The technique interpolates between standard statistical energy analysis and full ray tracing, containing both of these methods as limiting cases. As such the applicability of the method is wide ranging and additionally includes the numerical modelling of problems in optics and more generally of linear wave problems in electromagnetics. In this work we consider a new approach to the method with enhanced versatility, enabling three-dimensional problems to be handled in a straightforward manner. The main challenge is the high dimensionality of the problem: we determine the wave energy density both as a function of the spatial coordinate and momentum (or direction) space. The momentum variables are expressed in separable (polar) coordinates facilitating the use of products of univariate basis expansions. However this is not the case for the spatial argument and so we propose to make use of automated mesh generating routines to both localise the approximation, allowing quadrature costs to be kept moderate, and give versatility in the code for different geometric configurations.