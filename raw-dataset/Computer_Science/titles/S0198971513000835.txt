Beyond preference: Modelling segregation under regulation 