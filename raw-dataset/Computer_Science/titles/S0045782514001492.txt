An impulse-based energy tracking method for collision resolution 