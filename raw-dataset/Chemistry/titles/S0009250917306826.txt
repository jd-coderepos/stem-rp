Stochastic DSMC method for dense bubbly flows: Methodology 