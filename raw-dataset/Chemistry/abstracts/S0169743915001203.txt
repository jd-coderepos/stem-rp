Locally weighted partial least squares (LW-PLS) is one of Just-in-Time (JIT) modeling methods; PLS is used to build a local linear regression model every time when output variables need to be estimated. The prediction accuracy of local models strongly depends on the definition of similarity between a newly obtained sample and past samples stored in a database. To calculate the similarity, the Euclidean distance and the Mahalanobis distance have been widely used, but they do not take account of the relationship between input and output variables. This fact limits the achievable performance of LW-PLS and other locally weight regression methods. Thus, in the present work, covariance-based locally weighted PLS (CbLW-PLS) is proposed by integrating LW-PLS and a new similarity index based on the covariance between input and output variables. CbLW-PLS was applied to two industrial problems: soft-sensor design for estimating unreacted NaOH concentration in an alkali washing tower in a petrochemical process, and process analytical technology (PAT) for estimating concentration of a residual drug substance in a pharmaceutical process. The proposed similarity index was compared with six conventional indexes based on distances, correlations, or regression coefficients. The results have demonstrated that CbLW-PLS achieved the best prediction performance of all in both case studies.