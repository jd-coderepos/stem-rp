This paper describes the use of a frequency domain, finite-difference scheme to simulate the impedance spectra of diffusion in porous microstructures. Both open and closed systems are investigated for a range of ideal geometries, as well as some randomly generated synthetic volumes and tomographically derived microstructural data. In many cases, the spectra deviate significantly from the conventional Warburg-type elements typically used to represent diffusion in equivalent circuit analysis. A key finding is that certain microstructures show multiple peaks in the complex plane, which may be misinterpreted as separate electrochemical processes in real impedance data. This is relevant to battery electrode design as the techniques for nano-scale fabrication become more widespread. This simulation tool is provided as an open-source MatLab application and is freely available online as part of the TauFactor platform.