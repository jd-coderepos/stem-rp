Efficient Configuration Space Construction and Optimization for Motion Planning 