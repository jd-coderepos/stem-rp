A thermodynamically consistent model for elastoplasticity, recovery, recrystallization and grain coarsening 