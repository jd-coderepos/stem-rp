Design and control of hybrid power and propulsion systems for smart ships: A review of developments 