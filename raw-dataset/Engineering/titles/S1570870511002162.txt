Decomposing broadcast algorithms using abstract MAC layers 