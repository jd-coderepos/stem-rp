A rolling horizon optimization framework for the simultaneous energy supply and demand planning in microgrids 