Decarbonising the built environment cost-effectively is a complex challenge public and private organisations are facing in their effort to tackle climate change. In this context, this work presents an integrated Technology Selection and Operation (TSO) optimisation model for distributed energy systems in commercial buildings. The purpose of the model is to simultaneously optimise the selection, capacity and operation of photovoltaic (PV) and battery systems; serving as a decision support framework for assessing technology investments. A steady-state mixed-integer linear programming (MILP) approach is employed to formulate the optimisation problem. The virtue of the TSO model comes from employing granular state-of-the-art datasets such as half-hourly electricity demands and prices, irradiance levels from weather stations, and technology databases; while also considering building specific attributes. Investment revenues are obtained from reducing grid electricity costs and providing fast-frequency response (FFR) ancillary services. A case study of a distribution centre in London, UK is showcased with the goal to identify which technologies can minimise total energy costs against a conventional system setup serving as a benchmark. Results indicate the best technology configuration is a combination of lithium-ion batteries and mono-crystalline silicon PVs worth a total investment of £1.72M. Due to the available space in the facility, the preferred PV capacity is 1.76MW, while the battery system has a 1.06MW power capacity and a 1.56MWh energy capacity. Although PV performance varies across seasons, the solution indicates almost 30% of the energy used on-site can be supplied by PVs while achieving a carbon reduction of 26%. Nonetheless, PV and battery systems seem to be a questionable investment as the proposed solution has an 8-year payback, despite a 5-year NPV savings of £300k, implying there is still a performance gap for such systems to be massively deployed across the UK. Overall, the TSO model provides valuable insights into real-world project evaluation and can help to reduce the uncertainty associated with capital-intensive projects; hence proving to be a powerful modelling framework for distributed energy technology assessments.