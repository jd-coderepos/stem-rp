A two-stage hierarchical Microgrid energy management method in an office building is proposed, which considers uncertainties from renewable generation, electric load demand, outdoor temperature and solar radiation. In stage 1, a day-ahead optimal economic dispatch method is proposed to minimize the daily Microgrid operating cost, with the virtual energy storage system being dispatched as a flexible resource. In stage 2, a two-layer intra-hour adjustment methodology is proposed to smooth the power exchanges at the point of common coupling by coordinating the virtual energy storage system and the electric vehicles at two different time scales. A Vehicle-to-Building control strategy was developed to dispatch the electric vehicles as a flexible resource. Numerical studies demonstrated that the proposed method is able to reduce the daily operating cost at the day-ahead dispatch stage and smooth the fluctuations of the electric power exchanges at the intra-hour adjustment stage.