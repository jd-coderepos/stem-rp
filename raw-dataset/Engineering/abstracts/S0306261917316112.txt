In the future due to continued integration of renewable energy sources, demand-side flexibility would be required for managing power grids. Building energy systems will serve as one possible source of energy flexibility. The degree of flexibility provided by building energy systems is highly restricted by power-to-heat conversion such as heat pumps and thermal energy storage possibilities of a building. To quantify building demand flexibility, it is essential to capture the dynamic response of the building energy system with thermal energy storage. To identify the maximum flexibility a buildingâ€™s energy system can provide, optimal control is required. In this paper, optimal control serves to determine in detail demand flexibility of an office building equipped with heat pump, electric heater, and thermal energy storage tanks. The demand flexibility is quantified using different performance indicators that sufficiently characterize flexibility in terms of size (energy), time (power) and costs. To fully describe power flexibility, the paper introduces the instantaneous power flexibility as power flexibility indicator. The instantaneous power flexibility shows the potential power flexibility of TES and power-to-heat in any case of charging, discharging or idle mode. A simulation case study is performed showing that a water tank, a phase change material tank, and a thermochemical material tank integrated with building heating system can be designed to provide flexibility with optimal control.