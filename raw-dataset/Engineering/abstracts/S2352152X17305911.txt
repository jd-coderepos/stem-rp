Electricity storage could prove essential for highly-renewable power systems, but the ability to model its operation and impacts is limited with current techniques. Studies based on historic market prices or other fixed price time-series are commonplace, but cannot account for the impacts of storage on prices, and thus over-estimate utilisation and profits. Power systems models which minimise total system cost cannot model the economic dispatch of storage based on market prices, and thus cannot consider large aggregators of storage devices who are not perfectly competitive. We demonstrate new algorithms which calculate the profit-maximising dispatch of storage accounting for its price effects, using simple functional programming. These are technology agnostic, and can consider short-term battery storage through to inter-seasonal chemical storage (e.g. power-to-gas). The models consider both competitive and monopolistic operators, and require 1–10 s to dispatch GWs of storage over one year. Using a case study of the British power system, we show that failure to model price effects leads to material errors in profits and utilisation with capacities above 100 MW in a ∼50 G W system. We simulate up to 10 GW of storage, showing dramatically different outcomes based on ownership. Compared to a perfectly competitive market, a monopolistic owner would restrict storage utilisation by 30% to increase profits by 85%, thus reducing its benefit to society via smoothing demand and output from intermittent renewables by 20%.