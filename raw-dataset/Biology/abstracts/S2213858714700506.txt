Summary Background Metformin is a first-line oral agent used in the treatment of type 2 diabetes, but glycaemic response to this drug is highly variable. Understanding the genetic contribution to metformin response might increase the possibility of personalising metformin treatment. We aimed to establish the heritability of glycaemic response to metformin using the genome-wide complex trait analysis (GCTA) method. Methods In this GCTA study, we obtained data about HbA1c concentrations before and during metformin treatment from patients in the Genetics of Diabetes Audit and Research in Tayside Scotland (GoDARTS) study, which includes a cohort of patients with type 2 diabetes and is linked to comprehensive clinical databases and genome-wide association study data. We applied the GCTA method to estimate heritability for four definitions of glycaemic response to metformin: absolute reduction in HbA1c; proportional reduction in HbA1c; adjusted reduction in HbA1c; and whether or not the target on-treatment HbA1c of less than 7% (53 mmol/mol) was achieved, with adjustment for baseline HbA1c and known clinical covariates. Chromosome-wise heritability estimation was used to obtain further information about the genetic architecture. Findings 5386 individuals were included in the final dataset, of whom 2085 had enough clinical data to define glycaemic response to metformin. The heritability of glycaemic response to metformin varied by response phenotype, with a heritability of 34% (95% CI 1–68; p=0·022) for the absolute reduction in HbA1c, adjusted for pretreatment HbA1c. Chromosome-wise heritability estimates suggest that the genetic contribution is probably from individual variants scattered across the genome, which each have a small to moderate effect, rather than from a few loci that each have a large effect. Interpretation Glycaemic response to metformin is heritable, thus glycaemic response to metformin is, in part, intrinsic to individual biological variation. Further genetic analysis might enable us to make better predictions for stratified medicine and to unravel new mechanisms of metformin action. Funding Wellcome Trust.