Summary Background Maternal obesity is associated with increased birthweight, and obesity and premature mortality in adult offspring. The mechanism by which maternal obesity leads to these outcomes is not well understood, but maternal hyperglycaemia and insulin resistance are both implicated. We aimed to establish whether the insulin sensitising drug metformin improves maternal and fetal outcomes in obese pregnant women without diabetes. Methods We did this randomised, double-blind, placebo-controlled trial in antenatal clinics at 15 National Health Service hospitals in the UK. Pregnant women (aged ≥16 years) between 12 and 16 weeks' gestation who had a BMI of 30 kg/m2 or more and normal glucose tolerance were randomly assigned (1:1), via a web-based computer-generated block randomisation procedure (block size of two to four), to receive oral metformin 500 mg (increasing to a maximum of 2500 mg) or matched placebo daily from between 12 and 16 weeks' gestation until delivery of the baby. Randomisation was stratified by study site and BMI band (30–39 vs ≥40 kg/m2). Participants, caregivers, and study personnel were masked to treatment assignment. The primary outcome was Z score corresponding to the gestational age, parity, and sex-standardised birthweight percentile of liveborn babies delivered at 24 weeks or more of gestation. We did analysis by modified intention to treat. This trial is registered, ISRCTN number 51279843. Findings Between Feb 3, 2011, and Jan 16, 2014, inclusive, we randomly assigned 449 women to either placebo (n=223) or metformin (n=226), of whom 434 (97%) were included in the final modified intention-to-treat analysis. Mean birthweight at delivery was 3463 g (SD 660) in the placebo group and 3462 g (548) in the metformin group. The estimated effect size of metformin on the primary outcome was non-significant (adjusted mean difference −0·029, 95% CI −0·217 to 0·158; p=0·7597). The difference in the number of women reporting the combined adverse outcome of miscarriage, termination of pregnancy, stillbirth, or neonatal death in the metformin group (n=7) versus the placebo group (n=2) was not significant (odds ratio 3·60, 95% CI 0·74–17·50; p=0·11). Interpretation Metformin has no significant effect on birthweight percentile in obese pregnant women. Further follow-up of babies born to mothers in the EMPOWaR study will identify longer-term outcomes of metformin in this population; in the meantime, metformin should not be used to improve pregnancy outcomes in obese women without diabetes. Funding The Efficacy and Mechanism Evaluation (EME) Programme, a Medical Research Council and National Institute for Health Research partnership.