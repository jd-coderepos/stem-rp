Summary Background The effect of currently used bariatric surgical procedures on the development of diabetes in obese people is not well defined. We aimed to assess the effect of bariatric surgery on development of type 2 diabetes in a large population of obese individuals. Methods We did a matched cohort study of adults (age 20–100 years) identified from a UK-wide database of family practices, who were obese (BMI ≥30 kg/m2) and did not have diabetes. We enrolled 2167 patients who had undergone bariatric surgery between Jan 1, 2002, and April 30, 2014, and matched them—according to BMI, age, sex, index year, and HbA1c—with 2167 controls who had not had surgery. Procedures included laparoscopic gastric banding (n=1053), gastric bypass (795), and sleeve gastrectomy (317), with two procedures undefined. The primary outcome was development of clinical diabetes, which we extracted from electronic health records. Analyses were adjusted for matching variables, comorbidity, cardiovascular risk factors, and use of antihypertensive and lipid-lowering drugs. Findings During a maximum of 7 years of follow-up (median 2·8 years [IQR 1·3–4·5]), 38 new diagnoses of diabetes were made in bariatric surgery patients and 177 were made in controls. By the end of 7 years of follow-up, 4·3% (95% CI 2·9–6·5) of bariatric surgery patients and 16·2% (13·3–19·6) of matched controls had developed diabetes. The incidence of diabetes diagnosis was 28·2 (95% CI 24·4–32·7) per 1000 person-years in controls and 5·7 (4·2–7·8) per 1000 person-years in bariatric surgery patients; the adjusted hazard ratio was 0·20 (95% CI 0·13–0·30, p<0·0001). This estimate was robust after varying the comparison group in sensitivity analyses, excluding gestational diabetes, or allowing for competing mortality risk. Interpretation Bariatric surgery is associated with reduced incidence of clinical diabetes in obese participants without diabetes at baseline for up to 7 years after the procedure. Funding UK National Institute for Health Research.