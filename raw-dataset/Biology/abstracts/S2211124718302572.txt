Summary Sensory information is encoded within the brain in distributed spatiotemporal patterns of neuronal activity. Understanding how these patterns influence behavior requires a method to measure and to bidirectionally perturb with high spatial resolution the activity of the multiple neuronal cell types engaged in sensory processing. Here, we combined two-photon holography to stimulate neurons expressing blue light-sensitive opsins (ChR2 and GtACR2) with two-photon imaging of the red-shifted indicator jRCaMP1a in the mouse neocortex in vivo. We demonstrate efficient control of neural excitability across cell types and layers with holographic stimulation and improved spatial resolution by opsin somatic targeting. Moreover, we performed simultaneous two-photon imaging of jRCaMP1a and bidirectional two-photon manipulation of cellular activity with negligible effect of the imaging beam on opsin excitation. This all-optical approach represents a powerful tool to causally dissect how activity patterns in specified ensembles of neurons determine brain function and animal behavior.