Comprehensive two-dimensional gas chromatography coupled with time-of-flight mass spectrometry (GC×GC/TOF-MS) has been applied to metabolomics analyses recently. However, retention time shifts in the two-dimensional gas chromatography will introduce difficulty to compare compound profiles obtained from multiple samples. In this work, a novel two-stage peak alignment algorithm has been developed for data analysis of GC×GC/TOF-MS. In the first stage, our algorithm detects and merges multiple peak entries of the same metabolite into one peak entry. After a z-score transformation of metabolite retention times, landmark peaks will be selected from all samples based on both two-dimensional retention times and mass spectrum similarity of fragment ions measured by Pearson's correlation coefficient. In the second stage, the original two-dimensional retention time shift will be corrected using a local linear fitting method. A progressive retention time map searching method is used to align peaks in all samples together based on the parameters optimized in the first stage. Our algorithm can avoid defining a threshold of retention time window and spectrum similarity, which is very difficult for the users since the experimental condition is always changed in different experimental runs, even for the repeat experiments. The experimental results show that our algorithm can work well in peak alignment from real biological samples, which is very important for the further analysis.