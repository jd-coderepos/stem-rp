Developments in Photovoltaic (PV) design software have progressed to modelling the string or even the module as the smallest system unit but current methods lack computational efficiency to fully consider cell mismatch effects due to partial shading. This paper presents a more efficient shading loss algorithm which generates an irradiance map of the array for each time step for individual cells or cell portions. Irradiance losses are calculated from both near and far obstructions which might cause shading of both beam and diffuse irradiance in a three-dimensional reference field. The irradiance map output from this model could be used to calculate the performance of each solar cell individually as part of an overarching energy yield model. A validation demonstrates the calculation of shading losses due to a chimney with less than one percent error when compared with measured values.