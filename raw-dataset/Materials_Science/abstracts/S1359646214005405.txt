Neutron diffraction was used to characterize the residual stresses in an as-sprayed tube-shaped steel preform. The measured residual stress distributions were compared with those simulated using finite element method by taking into account the effects of the thermal history, porosity and different phases of the sprayed preform. The porosity was measured using X-ray microcomputed tomography. The study revealed for the first time the correlation between the distribution of porosity and residual stress developed in the as-sprayed preform.